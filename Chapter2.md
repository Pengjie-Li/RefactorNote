# Chapter 2 重构原则 #

## 2.1 重构的定义
---
重构的定义: 对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，最大的目的是降低修改成本
---
* 两顶帽子: 添加新功能和重构要独立进行

## 2.2 为何重构 ##
---
 不重构的代码会慢慢腐败，偏离原来的设计
---
* 有时候是为了快速完成任务，有时候是程序员本身没有想清楚
* 改进的重要方向:消除重复代码
* 重构可以协助理解不熟悉的代码
	* 自己动手修改代码可以更好地反映自己的理解，重新执行，看她是否仍然正常运作
* 重构可以让自己看到更远的地方
	* 一开始的重构都是些细枝末节
	* 随着代码趋于简洁，可以看到以前看不到的设计层面的问题
	* 擦掉窗户上的污垢可以让你看的更远
* 重构可以帮助你更快地开发程序
	* 良好的设计才能快速开发,阻止系统腐败
## 2.3 何时重构 ##
* 不要专门预留时间重构
* 事不过三,当一件事情让你三次为难，这就是重构的时机
	* 重构最常见的时机：添加新特性的时候
* 重构时机
	* 发现逻辑重复
	* 添加新行为需要改动已有代码
	* 复杂条件逻辑,逻辑尽可能只在唯一地点指定
## 2.4 怎么和经理说 ##
* 谈代码质量，谈进度，谈开发速度
* 以及不和经理说
## 2.5 重构的难题 ##
* 重构有局限，但是由于我们缺少足够的经验，目前还看不到它的局限
* 面对已公布的接口，需要重构，可以采用的策略是让旧接口调用新的接口
	*　简而言之，让旧接口继续工作，同时设计新的接口
	* 标记:deprecated ，使得调用者注意到这个接口即将过时
	* 不要过早发布接口,修改代码所有权政策，让重构更加顺畅
* 重构是一个还债的过程，复杂的代码维护就是高额的利息
	* 项目的最后阶段要避免重构

## 2.6 重构与设计 ## 

* 重构与设计彼此互补
* 找到足够合理的预先设计，然后补充以重构
	* 变更设计的代价非常高昂

##　重构与性能 ## 
* 重构可能会损失部分性能
* 三种方法
	* 时间预算法：计算每一部分的时间和资源,要求太高
	* 持续关注法: 写代码的时候设法保持系统的高性能,这种最常见
		* 大半时间会花费在一小半代码上，所以一视同仁所有的代码是有点浪费注意力的
	* 性能提升法：项目进入到性能优化阶段再调节性能
## 重构的起源 ##
* 重构是一门极为重要的技术
